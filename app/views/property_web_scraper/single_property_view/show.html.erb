<!-- Hero Section -->
<section class="pws-hero mb-4" style="background-image: url('<%= @main_image_url %>');">
  <div class="text-center">
    <% if @listing.for_sale %>
      <h1 class="display-4">Property For Sale</h1>
    <% end %>
    <% if @listing.for_rent %>
      <h1 class="display-4">Property For Rent</h1>
    <% end %>
    <p class="display-6"><%= @listing.title %></p>
  </div>
</section>

<!-- Description -->
<section class="mb-4">
  <div class="container">
    <h3>Description</h3>
    <%= sanitize_html(@listing.description) %>

    <div class="pws-social mt-3">
      <% share_url = request.original_url %>
      <% share_title = @listing.title || "Property Listing" %>
      <a href="https://www.facebook.com/sharer/sharer.php?u=<%= ERB::Util.url_encode(share_url) %>" target="_blank" title="Share on Facebook">
        <i class="bi bi-facebook"></i>
      </a>
      <a href="https://www.linkedin.com/sharing/share-offsite/?url=<%= ERB::Util.url_encode(share_url) %>" target="_blank" title="Share on LinkedIn">
        <i class="bi bi-linkedin"></i>
      </a>
      <a href="https://twitter.com/intent/tweet?url=<%= ERB::Util.url_encode(share_url) %>&text=<%= ERB::Util.url_encode(share_title) %>" target="_blank" title="Share on Twitter">
        <i class="bi bi-twitter-x"></i>
      </a>
    </div>
  </div>
</section>

<!-- Image Carousel -->
<% if @listing.image_urls.present? && @listing.image_urls.length > 0 %>
  <section class="mb-4" data-controller="carousel">
    <div id="propertyCarousel" class="carousel slide" data-bs-ride="carousel">
      <div class="carousel-indicators">
        <% @listing.image_urls.each_with_index do |_url, index| %>
          <button type="button" data-bs-target="#propertyCarousel" data-bs-slide-to="<%= index %>"
            <% if index == 0 %>class="active" aria-current="true"<% end %>
            aria-label="Slide <%= index + 1 %>"></button>
        <% end %>
      </div>
      <div class="carousel-inner">
        <% @listing.image_urls.each_with_index do |image_url, index| %>
          <div class="carousel-item<%= ' active' if index == 0 %>">
            <img src="<%= image_url %>" class="d-block w-100" alt="Property image <%= index + 1 %>" style="max-height: 500px; object-fit: cover;">
          </div>
        <% end %>
      </div>
      <button class="carousel-control-prev" type="button" data-bs-target="#propertyCarousel" data-bs-slide="prev">
        <span class="carousel-control-prev-icon" aria-hidden="true"></span>
        <span class="visually-hidden">Previous</span>
      </button>
      <button class="carousel-control-next" type="button" data-bs-target="#propertyCarousel" data-bs-slide="next">
        <span class="carousel-control-next-icon" aria-hidden="true"></span>
        <span class="visually-hidden">Next</span>
      </button>
    </div>
  </section>
<% end %>

<!-- Property Details -->
<section class="mb-4">
  <div class="container">
    <%= render partial: '/property_web_scraper/single_property_view/property_info_list' %>
  </div>
</section>

<!-- Map -->
<% if @markers.present? && @markers.length > 0 %>
  <section class="mb-4">
    <div class="container">
      <h3>Location</h3>
      <div data-controller="google-map"
           data-google-map-markers-value="<%= @markers.to_json %>"
           data-google-map-zoom-value="15"
           data-google-map-api-key-value="<%= ENV['GOOGLE_MAPS_API_KEY'] %>">
        <div data-google-map-target="container" class="pws-map"></div>
      </div>
    </div>
  </section>
<% end %>

<!-- About -->
<section class="mb-4">
  <div class="container">
    <div class="row">
      <div class="col-md-6">
        <div class="card">
          <div class="card-body">
            <h5 class="card-title">About PropertyWebScraper</h5>
            <p class="card-text">PropertyWebScraper was created to help users of the <a href="https://github.com/etewiah/property_web_builder">open source real estate website builder</a> import listings into their website.</p>
            <p class="card-text text-muted">Scraping websites for information has legal implications. Please ensure that you use it legally.</p>
          </div>
        </div>
      </div>
      <div class="col-md-6">
        <div class="card">
          <div class="card-body">
            <h5 class="card-title">Find out more</h5>
            <p class="card-text">Find out more about PropertyWebScraper and PropertyWebBuilder from the links below.</p>
            <div class="pws-social">
              <a href="https://github.com/etewiah/property_web_builder" title="GitHub" target="_blank"><i class="bi bi-github"></i></a>
              <a href="https://www.facebook.com/propertywebbuilder" title="Facebook" target="_blank"><i class="bi bi-facebook"></i></a>
              <a href="https://twitter.com/prptywebbuilder" title="Twitter" target="_blank"><i class="bi bi-twitter-x"></i></a>
              <a href="https://www.linkedin.com/company/propertywebbuilder" title="LinkedIn" target="_blank"><i class="bi bi-linkedin"></i></a>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</section>
